<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,
    maximum-scale=1.0 minimum-scale=1.0 ,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/normalize.css" type="text/css" />
    <link rel="stylesheet" href="css/index.css" type="text/css" />
    <script src="js/jquery-2.1.4.js"></script>
    <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
    <script src="js/index.js"></script>
    <title>小程序嵌套H5跳回小程序首页并传参</title>
</head>

<body>
    <!-- 搜索栏start -->
    <div class="search-content">
        <a href="javascript:;" class="category"></a>
        <div class="search-box">
            <form action="" method="">
                <input type="search" name="" id="p-name" />
            </form>
        </div>
        <a href="javascript:;" class="login">登录</a>

    </div>
    <!-- 搜索栏end -->
	<section>
		<div class="con">
			<input type="text" id="testinput" placeholder="请输入号码" value="123" class="input"/>
			<br/>
	                <button type="button" id="testbtn" class="btn">跳回小程序</button>
			<br/>
		</div>
		<br/>
		<div class="con">
			<br/>
			<P>小程序传递过来的参数channel：<span id="channel"></span></p>
			<br/>
			<P>小程序传递过来的参数testarg：<span id="testarg"></span></p>
		</div>
	</section>

    <script>
    	function GetQueryString(name) { //截取链接中的参数
		    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
		    var r = window.location.search.substr(1).match(reg);
		    if (r != null) return unescape(r[2]); return null;
		}
    	var testarg = GetQueryString("testarg");
    	var channel = GetQueryString("channel");
		$("#channel").html(channel);
    	$("#testarg").html(testarg);
		$(document).on('click', '#testbtn',function(){
			if (channel && channel == 'wechat'){
				var testnum = $("#testinput").val();
			    wx.miniProgram.switchTab({
			        url: '/pages/home/home'  //此处的url是你小程序里面页面的路由 tab页不可以传参
			    });
			} 
		});
    	
    </script>

</body>

</html>
